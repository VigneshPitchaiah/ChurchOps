{% extends "base.html" %}

{% block title %}Services - Church Attendance System{% endblock %}

{% block head %}
<style>
    .service-card {
        margin-bottom: 1rem;
        padding: 1rem;
        border-radius: 4px;
        border: 1px solid #e0e0e0;
        background-color: #fff;
        transition: box-shadow 0.3s ease;
    }
    .service-card:hover {
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    .service-date {
        font-weight: bold;
        color: var(--primary-color);
        margin-bottom: 0.5rem;
    }
    .service-time {
        font-size: 0.9rem;
        color: #666;
        margin-bottom: 0.5rem;
    }
    .service-actions {
        margin-top: 1rem;
    }
    
    /* Mobile table adjustments */
    @media (max-width: 768px) {
        table {
            font-size: 0.9rem;
        }
        th, td {
            padding: 0.4rem;
        }
        /* Stack the services table for better mobile view */
        .service-table-container {
            overflow-x: auto;
        }
    }
    
    /* For very small screens, convert table to cards */
    @media (max-width: 480px) {
        table {
            display: none; /* Hide the table on very small screens */
        }
        .services-list {
            display: block;
        }
        .service-card {
            display: block;
        }
        .hidden-card {
            display: none;
        }
    }
</style>
{% endblock %}

{% block content %}
<div class="card">
    <h1>Upcoming Services</h1>
    <p>Select a service to mark attendance.</p>
    
    {% if services %}
        <!-- Regular table view (hidden on very small screens) -->
        <div class="service-table-container">
            <table>
                <thead>
                    <tr>
                        <th>Service</th>
                        <th>Date</th>
                        <th>Time</th>
                        <th>Notes</th>
                        <th>Action</th>
                    </tr>
                </thead>
                <tbody>
                    {% for service in services %}
                    <tr>
                        <td>{{ service[1] }}</td>
                        <td>{{ service[2] }}</td>
                        <td>{{ service[3] }}</td>
                        <td>{{ service[4] or '' }}</td>
                        <td>
                            <a href="{{ url_for('attendance', service_id=service[0]) }}" class="btn">Mark Attendance</a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <!-- Card view for small screens (hidden on larger screens) -->
        <div class="services-list hidden-card">
            {% for service in services %}
            <div class="service-card">
                <div class="service-date">{{ service[1] }} - {{ service[2] }}</div>
                <div class="service-time">{{ service[3] }}</div>
                {% if service[4] %}
                <div class="service-notes">{{ service[4] }}</div>
                {% endif %}
                <div class="service-actions">
                    <a href="{{ url_for('attendance', service_id=service[0]) }}" class="btn">Mark Attendance</a>
                </div>
            </div>
            {% endfor %}
        </div>
    {% else %}
        <p>No upcoming services found.</p>
    {% endif %}
</div>

<script>
    // Check screen size and toggle between table and card views
    function checkScreenSize() {
        const tableContainer = document.querySelector('.service-table-container');
        const servicesList = document.querySelector('.services-list');
        
        if (window.innerWidth <= 480) {
            tableContainer.style.display = 'none';
            servicesList.classList.remove('hidden-card');
        } else {
            tableContainer.style.display = 'block';
            servicesList.classList.add('hidden-card');
        }
    }
    
    // Run on page load
    document.addEventListener('DOMContentLoaded', checkScreenSize);
    
    // Run on window resize
    window.addEventListener('resize', checkScreenSize);
</script>
{% endblock %}
